---
phase: 01-foundation
plan: 01
type: execute
---

<objective>
Set up Next.js project with database foundation for the bandwidth quoting platform.

Purpose: Establish the core project structure, database schema, and development environment that all subsequent phases build upon.
Output: Working Next.js app with Prisma database, Lead and Quote models, and proper project structure.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Tech decisions:**
- Next.js 14+ with App Router (modern React patterns, API routes)
- TypeScript (type safety)
- Tailwind CSS (utility-first styling)
- Prisma ORM (type-safe database access)
- SQLite for development (easy setup, switch to PostgreSQL for production)

**Database models needed:**
- Lead: name, email, phone, company, createdAt
- Quote: leadId, street_address, city, state, zip_code, speed, term, status, mrc, nrc, quote_request_id, createdAt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Next.js project with TypeScript and Tailwind</name>
  <files>package.json, tsconfig.json, tailwind.config.ts, next.config.js, src/app/layout.tsx, src/app/page.tsx, src/app/globals.css</files>
  <action>
Create a new Next.js project in the current directory using create-next-app with these options:
- TypeScript: Yes
- ESLint: Yes
- Tailwind CSS: Yes
- src/ directory: Yes
- App Router: Yes
- Import alias: @/*

Run: `npx create-next-app@latest . --typescript --tailwind --eslint --app --src-dir --import-alias "@/*" --use-npm`

If directory not empty, use --yes to accept defaults. After creation, verify the project runs with `npm run dev`.
  </action>
  <verify>npm run dev starts without errors, localhost:3000 shows Next.js welcome page</verify>
  <done>Next.js project created with TypeScript, Tailwind, App Router structure in place</done>
</task>

<task type="auto">
  <name>Task 2: Set up Prisma with database schema</name>
  <files>prisma/schema.prisma, src/lib/db.ts, .env</files>
  <action>
1. Install Prisma: `npm install prisma @prisma/client`
2. Initialize Prisma: `npx prisma init --datasource-provider sqlite`
3. Create schema in prisma/schema.prisma:

```prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Lead {
  id        String   @id @default(cuid())
  name      String
  email     String
  phone     String
  company   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  quotes    Quote[]
}

model Quote {
  id              String   @id @default(cuid())
  leadId          String
  lead            Lead     @relation(fields: [leadId], references: [id])
  streetAddress   String
  city            String
  state           String
  zipCode         String
  speed           String
  term            String
  status          String   @default("pending") // pending, processing, complete, failed
  quoteRequestId  String?  // From Momentum API
  mrc             Float?   // Monthly recurring charge
  nrc             Float?   // Non-recurring charge
  carrierName     String?
  errorMessage    String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}
```

4. Ensure .env has: `DATABASE_URL="file:./dev.db"`
5. Run migration: `npx prisma migrate dev --name init`
6. Generate client: `npx prisma generate`

7. Create src/lib/db.ts for Prisma client singleton:
```typescript
import { PrismaClient } from '@prisma/client'

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined
}

export const db = globalForPrisma.prisma ?? new PrismaClient()

if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = db
```

8. Add prisma/dev.db to .gitignore
  </action>
  <verify>npx prisma validate passes, npx prisma studio opens and shows Lead and Quote tables</verify>
  <done>Prisma configured with Lead and Quote models, database migrations applied, client generated</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run dev` starts without errors
- [ ] `npx prisma validate` passes
- [ ] `npx prisma studio` opens and shows Lead/Quote tables
- [ ] No TypeScript errors in src/lib/db.ts
</verification>

<success_criteria>
- Next.js project created with TypeScript, Tailwind, App Router
- Prisma installed and configured with SQLite
- Lead and Quote models defined and migrated
- Database client singleton created
- Development server runs successfully
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
